RabbitMQ


1) Install 


sudo apt-get update -y
wget http://packages.erlang-solutions.com/ubuntu/erlang_solutions.asc
sudo apt-key add erlang_solutions.asc
sudo apt-get update -y
sudo apt-get install erlang -y
sudo apt-get install erlang-nox -y
sudo echo 'deb http://www.rabbitmq.com/debian testing main' | sudo tee /etc/apt/sources.list.d/rabbitmq.list
wget -O- https://www.rabbitmq.com/rabbitmq-release-signing-key.asc | sudo apt-key add -
sudo apt-get update
sudo apt-get install rabbitmq-server
sudo systemctl enable rabbitmq-server
sudo systemctl start rabbitmq-server
sudo rabbitmq-plugins enable rabbitmq_management



2) User managment

sudo rabbitmqctl add_user stepanover
sudo rabbitmqctl set_user_tags stepanover administrator
sudo rabbitmqctl set_permissions -p / stepanover ".*" ".*" ".*"
sudo systemctl restart rabbitmq-server

sudo rabbitmqctl add_user admin
sudo rabbitmqctl set_user_tags admin administrator
sudo rabbitmqctl set_permissions -p / admin ".*" ".*" ".*"
sudo systemctl restart rabbitmq-server

sudo rabbitmqctl add_user producer
pass : jbfFUH4#685GB#vff
sudo rabbitmqctl set_user_tags producer administrator
sudo rabbitmqctl set_permissions -p / producer ".*" ".*" ".*"
sudo systemctl restart rabbitmq-server




3) Setup cluster

sudo systemctl stop rabbitmq-server

1st node
sudo rabbitmqctl stop_app
sudo rabbitmqctl reset
sudo rabbitmqctl start_app

2nd node
sudo rabbitmqctl stop_app
sudo rabbitmqctl reset
sudo rabbitmqctl join_cluster rabbit@kr01-net-sys-rbmq01
sudo rabbitmqctl start_app


sudo rabbitmqctl set_policy ha-all '.*' '{"ha-mode":"all", "ha-sync-mode":"automatic"}'


